---
title: 支持软件更新 A/D 位
linkTitle: 14.Software_update_A/D
weight: 12
---

`A` 位（`Access`）用于指示某一页面是否被访问过。如果处理器对该页面进行任何形式的访问（读/写/取指），则 `A` 位会被设置为 `1`。每当 `CPU` 访问某个页面时，操作系统或硬件会自动将 `A` 位设置为 `1`，这种更新通常是硬件支持的，由处理器在地址转换时自动进行。

`D` 位（`Dirty`）指示页面是否被修改。如果页面在内存中被写入，则 `D` 位会被设置为 `1`，表示该页面的内容已被更改。当处理器对页面进行写操作时，通常会自动将 `D` 位设置为 `1`，这种更新通常也是由硬件支持的。在页面替换过程中，操作系统会检查 `D` 位，如果 `D` 位为 `1`，操作系统会将页面写回到磁盘，并在写回后清除 `D` 位，以表示页面已经被保存且不再是“脏”的。

在香山昆明湖架构中，并不支持硬件更新 `A/D` 位，而是在需要更新的时候通过 `Page Fault` 通知软件进行页表更新。具体来说，每当处理器访问某一页时检查该页 `A` 位如果是 `0`，那么会发生 `PF`；同样的，每当处理器写入某一页时检查该页的 `D` 位如果是 `0`，同样会发生 `PF`。在软件处理异常后，操作系统会允许处理器再次访问页面，只有在页表得到更新且相关状态位（`A` 和 `D` 位）被正确设置后，处理器才能继续进行后续的内存访问。